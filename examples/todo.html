<!-- capabilities: ["ui:window", "storage:local"] -->
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<style>
  body { margin: 0; padding: 20px; background: #1a1a2e; color: #e0e0e0; font-family: 'Segoe UI', sans-serif; }
  h2 { font-size: 18px; color: #6c63ff; margin-bottom: 16px; }
  .input-row { display: flex; gap: 8px; margin-bottom: 16px; }
  input[type="text"] { flex: 1; background: #0d0d1a; border: 1px solid #2a2a4a; border-radius: 6px; padding: 10px 14px; color: #e0e0e0; font-size: 14px; outline: none; }
  input[type="text"]:focus { border-color: #6c63ff; }
  button { background: #6c63ff; border: none; border-radius: 6px; padding: 10px 18px; color: white; font-size: 13px; cursor: pointer; }
  button:hover { background: #7b73ff; }
  .todo-list { list-style: none; }
  .todo-item { display: flex; align-items: center; gap: 10px; padding: 10px 0; border-bottom: 1px solid #1e1e3a; }
  .todo-item.done .text { text-decoration: line-through; color: #555577; }
  .todo-item input[type="checkbox"] { accent-color: #6c63ff; width: 18px; height: 18px; }
  .todo-item .text { flex: 1; font-size: 14px; }
  .todo-item .delete { background: none; border: none; color: #555577; cursor: pointer; font-size: 16px; padding: 0 4px; }
  .todo-item .delete:hover { color: #ff4757; }
  .count { font-size: 12px; color: #555577; margin-top: 12px; }
</style>
</head>
<body>
<h2>Todo List</h2>
<div class="input-row">
  <input type="text" id="input" placeholder="What needs to be done?">
  <button id="add-btn">Add</button>
</div>
<ul class="todo-list" id="list"></ul>
<div class="count" id="count"></div>
<script>
  let todos = [];

  async function load() {
    const saved = await LLMOS.storage.get('todos');
    if (saved) todos = saved;
    render();
  }

  async function save() {
    await LLMOS.storage.set('todos', todos);
  }

  function render() {
    const list = document.getElementById('list');
    const count = document.getElementById('count');
    list.innerHTML = '';

    for (let i = 0; i < todos.length; i++) {
      const item = todos[i];
      const li = document.createElement('li');
      li.className = 'todo-item' + (item.done ? ' done' : '');

      const cb = document.createElement('input');
      cb.type = 'checkbox';
      cb.checked = item.done;
      cb.onchange = () => { todos[i].done = !todos[i].done; save(); render(); };

      const text = document.createElement('span');
      text.className = 'text';
      text.textContent = item.text;

      const del = document.createElement('button');
      del.className = 'delete';
      del.textContent = '\u00d7';
      del.onclick = () => { todos.splice(i, 1); save(); render(); };

      li.append(cb, text, del);
      list.appendChild(li);
    }

    const remaining = todos.filter(t => !t.done).length;
    count.textContent = `${remaining} item${remaining !== 1 ? 's' : ''} remaining`;
  }

  function addTodo() {
    const input = document.getElementById('input');
    const text = input.value.trim();
    if (!text) return;
    todos.push({ text, done: false });
    input.value = '';
    save();
    render();
  }

  document.getElementById('add-btn').onclick = addTodo;
  document.getElementById('input').onkeydown = (e) => { if (e.key === 'Enter') addTodo(); };

  load();
</script>
</body>
</html>
